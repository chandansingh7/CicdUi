@use '@angular/material' as mat;
@use 'variables' as v;
@use 'typography';

// ─── Angular Material Theme ───────────────────────────────────────────────────
@include mat.core();

$primary: mat.define-palette(mat.$indigo-palette, 700);
$accent:  mat.define-palette(mat.$blue-palette, A200);
$warn:    mat.define-palette(mat.$red-palette);

$theme: mat.define-light-theme((
  color:      (primary: $primary, accent: $accent, warn: $warn),
  typography: mat.define-typography-config(),
  density:    0,
));

@include mat.all-component-themes($theme);

// ─── Global Reset ────────────────────────────────────────────────────────────
*, *::before, *::after { box-sizing: border-box; }

html, body {
  height: 100%;
  margin: 0;
  background: v.$color-background;
}

// ─── Global Layout Helpers ───────────────────────────────────────────────────
.full-width  { width: 100%; }
.spacer      { flex: 1; }

// ─── Spacing Utilities ───────────────────────────────────────────────────────
.mt-8  { margin-top: v.$space-sm; }
.mt-16 { margin-top: v.$space-md; }
.mt-24 { margin-top: v.$space-lg; }
.mb-8  { margin-bottom: v.$space-sm; }
.mb-16 { margin-bottom: v.$space-md; }
.mb-24 { margin-bottom: v.$space-lg; }

// ─── Page Header (used globally) ─────────────────────────────────────────────
.page-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  margin-bottom: v.$space-lg;

  h2 {
    margin: 0;
    font-size: v.$font-size-xl;
    font-weight: v.$font-weight-semibold;
    color: v.$color-primary;
  }
}

// ─── Search Bar ──────────────────────────────────────────────────────────────
.search-bar {
  display: flex;
  gap: v.$space-md;
  margin-bottom: v.$space-md;
  align-items: flex-start;
}

// ─── Card ────────────────────────────────────────────────────────────────────
.card {
  border-radius: v.$radius-lg !important;
  box-shadow: v.$shadow-md !important;
}

// ─── Status Chip Classes ─────────────────────────────────────────────────────
.chip-in-stock    { background: v.$color-success-bg !important; color: v.$color-success !important; }
.chip-low-stock   { background: v.$color-warn-bg !important;    color: v.$color-warn !important; }
.chip-out-of-stock{ background: v.$color-danger-bg !important;  color: v.$color-danger !important; }
.chip-completed   { background: v.$color-success-bg !important; color: v.$color-success !important; }
.chip-pending     { background: v.$color-pending-bg !important; color: v.$color-pending !important; }
.chip-cancelled   { background: v.$color-danger-bg !important;  color: v.$color-danger !important; }

// ─── Data Table — HCI Standards (NNG / Shopify Polaris / Stripe level) ────────
//
// Header:  40px, #FAFAFA bg, 12px semibold muted uppercase labels, 2px border
// Rows:    44px min, 1px divider, 14px body text, hover #F5F7FA
// Numbers: right-aligned + tabular-nums (prices, qty, IDs)
// Chips:   22px pill, 11px semibold, semantic color pairs
// Source:  Nielsen Norman Group, Shopify Polaris, Stripe Dashboard

.mat-mdc-table {
  border-radius: v.$radius-md;
  overflow: hidden;
  font-size: v.$font-size-base;   // 14px body text
}

// ── Header row ───────────────────────────────────────────────────────────────
.mat-mdc-header-row {
  height: auto !important;
  min-height: 40px !important;
  background: #fafafa !important;
  border-bottom: 2px solid v.$color-border !important;
}

.mat-mdc-header-cell {
  font-size: v.$font-size-sm !important;          // 12px
  font-weight: v.$font-weight-semibold !important; // 600
  color: v.$color-text-secondary !important;       // #616161
  letter-spacing: 0.05em !important;
  text-transform: uppercase !important;
  padding-top: 4px !important;
  padding-bottom: 4px !important;
  border-bottom: none !important;
}

// ── Data rows ────────────────────────────────────────────────────────────────
.mat-mdc-row {
  height: auto !important;
  min-height: 44px !important;
  border-bottom: 1px solid v.$color-divider !important;
  transition: background v.$transition-fast;

  &:hover { background: #f5f7fa !important; }
  &:last-child { border-bottom: none !important; }
}

.mat-mdc-cell {
  font-size: v.$font-size-base !important;  // 14px
  color: v.$color-text-primary !important;  // #212121
  padding-top: 8px !important;
  padding-bottom: 8px !important;
  border-bottom: none !important;
}

// ── Filter mat-select in table headers — match 11px compact text ─────────────
// mat-select value/placeholder text does not inherit from mat-form-field-infix;
// must be targeted directly on the trigger and value elements.
.mat-mdc-header-cell {
  .mat-mdc-select,
  .mat-mdc-select-trigger,
  .mat-mdc-select-value,
  .mat-mdc-select-value-text,
  .mat-mdc-select-placeholder {
    font-size: 11px !important;
    line-height: 1 !important;
  }
}

// ── Numeric/price columns — right-aligned tabular numbers ────────────────────
// Apply class="num-cell" to <td> and class="num-th" to <th> for price/qty/ID
.num-cell, .price-cell {
  text-align: right !important;
  font-variant-numeric: tabular-nums !important;
  letter-spacing: 0.02em;
}
.num-header, .price-header {
  text-align: right !important;
}

// ── Status chips — 22px pill, 11px semibold ──────────────────────────────────
.mat-mdc-chip, mat-chip {
  height: 22px !important;
  min-height: 22px !important;
  font-size: v.$font-size-xs !important;     // 11px
  font-weight: v.$font-weight-semibold !important;
  letter-spacing: 0.03em !important;
  border-radius: v.$radius-pill !important;
  padding: 0 8px !important;
  line-height: 22px !important;
}

// ─── Snackbar Toasts ─────────────────────────────────────────────────────────
.snack-success .mdc-snackbar__surface {
  background: v.$color-success !important;
  color: white !important;
  border-radius: v.$radius-md !important;

  .mat-mdc-snack-bar-label { color: white !important; font-weight: v.$font-weight-medium; }
  button { color: rgba(255,255,255,0.8) !important; }
}

.snack-error .mdc-snackbar__surface {
  background: v.$color-danger !important;
  color: white !important;
  border-radius: v.$radius-md !important;

  .mat-mdc-snack-bar-label { color: white !important; font-weight: v.$font-weight-medium; }
  button { color: rgba(255,255,255,0.8) !important; }
}

.snack-info .mdc-snackbar__surface {
  background: v.$color-info !important;
  color: white !important;
  border-radius: v.$radius-md !important;

  .mat-mdc-snack-bar-label { color: white !important; }
  button { color: rgba(255,255,255,0.8) !important; }
}

// Error snackbar — shown by ErrorInterceptor for all HTTP errors
// Includes error code prefix e.g. "[AU004] Access denied..."
.error-snackbar .mdc-snackbar__surface {
  background: #c62828 !important;
  color: white !important;
  border-radius: v.$radius-md !important;
  min-width: 360px;
  max-width: 600px;

  .mat-mdc-snack-bar-label {
    color: white !important;
    font-weight: v.$font-weight-medium;
    font-family: monospace;   // makes the code prefix stand out
    letter-spacing: 0.01em;
  }
  button { color: rgba(255,255,255,0.8) !important; }
}
