<h2 mat-dialog-title class="dialog-title">
  <mat-icon>lock_reset</mat-icon>
  Change Password
</h2>

<mat-dialog-content>
  <p class="dialog-hint">Enter your current password, then choose a new one (minimum 6 characters).</p>

  <form [formGroup]="form" (ngSubmit)="submit()" autocomplete="off">

    <mat-form-field appearance="outline" class="full-width">
      <mat-label>Current Password</mat-label>
      <input matInput [type]="hideCurrentPwd ? 'password' : 'text'"
             formControlName="currentPassword" autocomplete="current-password">
      <mat-icon matPrefix>lock</mat-icon>
      <button mat-icon-button matSuffix type="button" (click)="hideCurrentPwd = !hideCurrentPwd">
        <mat-icon>{{ hideCurrentPwd ? 'visibility_off' : 'visibility' }}</mat-icon>
      </button>
      <mat-error>{{ getError('currentPassword') }}</mat-error>
    </mat-form-field>

    <mat-divider class="divider"></mat-divider>

    <mat-form-field appearance="outline" class="full-width">
      <mat-label>New Password</mat-label>
      <input matInput [type]="hideNewPwd ? 'password' : 'text'"
             formControlName="newPassword" autocomplete="new-password">
      <mat-icon matPrefix>lock_open</mat-icon>
      <button mat-icon-button matSuffix type="button" (click)="hideNewPwd = !hideNewPwd">
        <mat-icon>{{ hideNewPwd ? 'visibility_off' : 'visibility' }}</mat-icon>
      </button>
      <mat-hint>Minimum 6 characters</mat-hint>
      <mat-error>{{ getError('newPassword') }}</mat-error>
    </mat-form-field>

    <mat-form-field appearance="outline" class="full-width">
      <mat-label>Confirm New Password</mat-label>
      <input matInput [type]="hideConfirmPwd ? 'password' : 'text'"
             formControlName="confirmPassword" autocomplete="new-password">
      <mat-icon matPrefix>lock_open</mat-icon>
      <button mat-icon-button matSuffix type="button" (click)="hideConfirmPwd = !hideConfirmPwd">
        <mat-icon>{{ hideConfirmPwd ? 'visibility_off' : 'visibility' }}</mat-icon>
      </button>
      <mat-error *ngIf="getError('confirmPassword')">{{ getError('confirmPassword') }}</mat-error>
      <mat-error *ngIf="confirmMismatch">Passwords do not match</mat-error>
    </mat-form-field>

  </form>
</mat-dialog-content>

<mat-dialog-actions align="end">
  <button mat-stroked-button mat-dialog-close [disabled]="loading">Cancel</button>
  <button mat-raised-button color="primary" (click)="submit()" [disabled]="loading">
    <mat-spinner diameter="18" *ngIf="loading" class="btn-spinner"></mat-spinner>
    <mat-icon *ngIf="!loading">save</mat-icon>
    {{ loading ? 'Updating...' : 'Update Password' }}
  </button>
</mat-dialog-actions>
