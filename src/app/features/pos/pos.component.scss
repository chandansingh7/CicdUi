@use 'theme' as t;

.pos-layout {
  display: grid;
  grid-template-columns: 1fr 380px;
  gap: t.$space-lg;
  height: calc(100vh - 140px);
  min-height: 0;

  @include t.sm { grid-template-columns: 1fr; }
}

.product-panel {
  display: flex;
  flex-direction: column;
  min-height: 0;
  overflow: hidden;
}

.search-controls {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: t.$space-md;
  margin-bottom: t.$space-md;

  @include t.xs { grid-template-columns: 1fr; }
}

.product-grid {
  flex: 1;
  min-height: 0;
  overflow-y: auto;
  overflow-x: hidden;
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
  gap: t.$space-md;
  align-content: start;
  padding-right: 4px;
}

.product-tile {
  cursor: pointer;
  transition: t.$transition-fast;
  border-radius: t.$radius-lg !important;

  &:hover:not(.out-of-stock) {
    transform: translateY(-2px);
    box-shadow: t.$shadow-lg !important;
  }

  &.out-of-stock { opacity: 0.5; cursor: not-allowed; }

  mat-card-content {
    padding: t.$space-md !important;
    display: flex;
    flex-direction: column;
    align-items: center;
    text-align: center;
    gap: t.$space-xs + 2px;
  }
}

.product-icon  { font-size: 36px; width: 36px; height: 36px; color: t.$color-primary-light; }
.product-name  { font-size: t.$font-size-sm; font-weight: t.$font-weight-semibold; line-height: t.$line-height-tight; }
.product-price { font-size: t.$font-size-md; font-weight: t.$font-weight-bold; color: t.$color-success; }
.product-stock { font-size: t.$font-size-xs; color: t.$color-success; &.low { color: t.$color-warn; } &.out { color: t.$color-danger-light; } }

.no-products {
  grid-column: 1 / -1;
  @include t.empty-state;
}

.cart-panel {
  background: t.$color-surface;
  border-radius: t.$radius-lg;
  box-shadow: t.$shadow-md;
  display: flex;
  flex-direction: column;
  overflow: hidden;
}

.cart-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 10px 12px 8px;
  min-height: 40px;

  h3 {
    margin: 0;
    font-size: t.$font-size-lg;
    font-weight: t.$font-weight-semibold;
    line-height: 1.2;
  }

  button.mat-mdc-icon-button {
    width: 36px;
    height: 36px;
    padding: 0;

    mat-icon { font-size: 20px; width: 20px; height: 20px; }
  }
}

.cart-items { flex: 1; overflow-y: auto; padding: 0 12px; min-height: 0; }

// ── Cart row: − number + $ × on one tight line ──────────────────────────────
.cart-item {
  display: flex;
  align-items: center;
  gap: 4px;
  padding: 5px 0;
  border-bottom: 1px solid t.$color-divider;
  min-height: 36px;
}

.cart-item .item-right-group {
  display: flex;
  align-items: center;
  gap: 4px;
  flex-shrink: 0;
}

.item-left {
  flex: 1;
  min-width: 0;
}

.item-name {
  display: block;
  font-size: 12px;
  font-weight: t.$font-weight-medium;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  line-height: 1.35;
  color: t.$color-text-primary;
}

.item-unit-price {
  display: block;
  font-size: 10px;
  color: t.$color-text-muted;
  line-height: 1.2;
}

// Stepper, subtotal, and remove: same 24px height so − number + $ × align on one line
.cart-item .item-stepper,
.cart-item .item-subtotal,
.cart-item .item-remove {
  flex-shrink: 0;
  height: 24px;
  display: flex;
  align-items: center;
}
.cart-item .item-stepper,
.cart-item .item-remove {
  justify-content: center;
}

.item-stepper {
  display: flex;
  align-items: center;
  gap: 0;
  background: #f0f2f5;
  border-radius: 6px;
  padding: 0 1px;
  height: 24px;
}

.step-btn {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  width: 20px;
  height: 20px;
  border: none;
  background: transparent;
  cursor: pointer;
  border-radius: 4px;
  color: t.$color-text-secondary;
  padding: 0;
  transition: background 0.15s;

  &:hover { background: rgba(0,0,0,0.08); color: t.$color-text-primary; }
  &:active { background: rgba(0,0,0,0.15); }

  mat-icon { font-size: 14px; width: 14px; height: 14px; line-height: 14px; }
}

.step-qty {
  font-size: 12px;
  font-weight: t.$font-weight-semibold;
  min-width: 20px;
  height: 24px;
  display: flex;
  align-items: center;
  justify-content: center;
  line-height: 1;
  color: t.$color-text-primary;
}

.item-subtotal {
  font-size: 12px;
  font-weight: t.$font-weight-bold;
  color: t.$color-primary;
  min-width: 40px;
  height: 24px;
  display: flex;
  align-items: center;
  justify-content: flex-end;
  text-align: right;
  padding-right: 2px;
}

.item-remove {
  width: 24px;
  height: 24px;
  border: none;
  background: transparent;
  cursor: pointer;
  border-radius: 50%;
  color: #bdbdbd;
  padding: 0;
  transition: color 0.15s, background 0.15s;

  &:hover { color: t.$color-danger-light; background: rgba(211,47,47,0.08); }

  mat-icon { font-size: 16px; width: 16px; height: 16px; line-height: 16px; }
}

// ── Cart footer form fields: small height, no label overlap ───────────────────
.compact-field {
  --mdc-outlined-text-field-container-height: 44px;
  margin-bottom: 4px;
  margin-top: 0;

  ::ng-deep .mat-mdc-form-field-subscript-wrapper { display: none; }
  ::ng-deep .mat-mdc-text-field-wrapper { padding: 0 10px; }
  ::ng-deep .mat-mdc-form-field-infix {
    padding-top: 10px;
    padding-bottom: 6px;
    min-height: 20px;
    box-sizing: border-box;
  }
  ::ng-deep .mat-mdc-select-value,
  ::ng-deep .mat-mdc-input-element { font-size: 13px; line-height: 1.2; }
  ::ng-deep .mat-mdc-floating-label {
    font-size: 11px;
    top: 50%;
  }
  ::ng-deep .mat-mdc-form-field.mat-mdc-form-field.mat-form-field-has-label .mat-mdc-floating-label.mdc-floating-label--float-above {
    top: 4px;
  }
  ::ng-deep .mat-mdc-form-field-icon-prefix { padding-right: 6px; }
  ::ng-deep .mat-mdc-form-field-icon-prefix .mat-icon { font-size: 18px; width: 18px; height: 18px; }
}

.compact-field-first { margin-top: 4px; }

.empty-cart {
  flex: 1;
  @include t.flex-column;
  align-items: center;
  justify-content: center;
  padding: t.$space-xxl t.$space-lg;
  color: t.$color-text-muted;

  mat-icon { font-size: 56px; width: 56px; height: 56px; color: t.$color-border; }
  p { font-size: t.$font-size-md; margin: t.$space-sm 0 t.$space-xs; }
  small { font-size: t.$font-size-sm; }
}

.cart-footer {
  flex-shrink: 0;
  padding: 8px 12px 10px;
  border-top: 1px solid t.$color-divider;
  background: #fafafa;

  .full-width {
    width: 100%;
    max-width: 100%;
  }
  .compact-field ::ng-deep .mat-mdc-text-field-wrapper {
    width: 100%;
    box-sizing: border-box;
  }
}

.totals { margin: 4px 0; display: flex; flex-direction: column; gap: 2px; }

.total-row-sm {
  display: flex;
  justify-content: space-between;
  font-size: t.$font-size-sm;
  color: t.$color-text-secondary;
  padding: 2px 0;
}

.total-row-lg {
  display: flex;
  justify-content: space-between;
  font-size: t.$font-size-lg;
  font-weight: t.$font-weight-bold;
  color: t.$color-primary;
  padding: t.$space-sm 0;
}

.checkout-btn { @include t.action-button; width: 100%; margin-top: 6px; min-height: 40px; }

.receipt-container { display: flex; justify-content: center; padding: t.$space-lg; }

.receipt-card { max-width: 480px; width: 100%; border-radius: t.$radius-lg !important; }

.receipt-header {
  text-align: center;
  padding: t.$space-md;

  .success-icon { font-size: 56px; width: 56px; height: 56px; color: t.$color-success; }
  h2 { margin: t.$space-sm 0 t.$space-xs; color: t.$color-success-light; }
  p  { margin: 0; color: t.$color-text-secondary; }
}

.receipt-body { padding: t.$space-md 0; display: flex; flex-direction: column; gap: t.$space-sm; }

.receipt-row   { display: flex; justify-content: space-between; font-size: t.$font-size-base; padding: t.$space-xs 0; }
.total-row     { font-size: t.$font-size-lg; font-weight: t.$font-weight-bold; color: t.$color-primary; padding: t.$space-sm 0; }

.loading-center { @include t.loading-center(t.$space-xl); }
