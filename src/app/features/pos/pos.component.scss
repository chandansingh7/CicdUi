@use 'theme' as t;

.pos-layout {
  display: grid;
  grid-template-columns: 1fr 380px;
  gap: t.$space-lg;
  height: calc(100vh - 140px);

  @include t.sm { grid-template-columns: 1fr; }
}

.product-panel { display: flex; flex-direction: column; overflow: visible; }

.search-controls {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: t.$space-md;
  margin-bottom: t.$space-md;

  @include t.xs { grid-template-columns: 1fr; }
}

.product-grid {
  flex: 1;
  overflow-y: auto;
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
  gap: t.$space-md;
  align-content: start;
}

.product-tile {
  cursor: pointer;
  transition: t.$transition-fast;
  border-radius: t.$radius-lg !important;

  &:hover:not(.out-of-stock) {
    transform: translateY(-2px);
    box-shadow: t.$shadow-lg !important;
  }

  &.out-of-stock { opacity: 0.5; cursor: not-allowed; }

  mat-card-content {
    padding: t.$space-md !important;
    display: flex;
    flex-direction: column;
    align-items: center;
    text-align: center;
    gap: t.$space-xs + 2px;
  }
}

.product-icon  { font-size: 36px; width: 36px; height: 36px; color: t.$color-primary-light; }
.product-name  { font-size: t.$font-size-sm; font-weight: t.$font-weight-semibold; line-height: t.$line-height-tight; }
.product-price { font-size: t.$font-size-md; font-weight: t.$font-weight-bold; color: t.$color-success; }
.product-stock { font-size: t.$font-size-xs; color: t.$color-success; &.low { color: t.$color-warn; } &.out { color: t.$color-danger-light; } }

.no-products {
  grid-column: 1 / -1;
  @include t.empty-state;
}

.cart-panel {
  background: t.$color-surface;
  border-radius: t.$radius-lg;
  box-shadow: t.$shadow-md;
  display: flex;
  flex-direction: column;
  overflow: hidden;
}

.cart-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: t.$space-md t.$space-md t.$space-sm;

  h3 { margin: 0; font-size: t.$font-size-lg; font-weight: t.$font-weight-semibold; }
}

.cart-items { flex: 1; overflow-y: auto; padding: 0 12px; min-height: 0; }

// ── Cart row ──────────────────────────────────────────────────────────────────
.cart-item {
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 6px 0;
  border-bottom: 1px solid t.$color-divider;
}

.item-left {
  flex: 1;
  min-width: 0;
}

.item-name {
  display: block;
  font-size: 12px;
  font-weight: t.$font-weight-medium;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  line-height: 1.4;
  color: t.$color-text-primary;
}

.item-unit-price {
  display: block;
  font-size: 10px;
  color: t.$color-text-muted;
  line-height: 1.2;
}

// ── Qty stepper ───────────────────────────────────────────────────────────────
.item-stepper {
  display: flex;
  align-items: center;
  gap: 0;
  background: #f0f2f5;
  border-radius: 6px;
  padding: 1px;
  flex-shrink: 0;
}

.step-btn {
  display: flex;
  align-items: center;
  justify-content: center;
  width: 22px;
  height: 22px;
  border: none;
  background: transparent;
  cursor: pointer;
  border-radius: 5px;
  color: t.$color-text-secondary;
  padding: 0;
  transition: background 0.15s;

  &:hover { background: rgba(0,0,0,0.08); color: t.$color-text-primary; }
  &:active { background: rgba(0,0,0,0.15); }

  mat-icon { font-size: 14px; width: 14px; height: 14px; line-height: 14px; }
}

.step-qty {
  font-size: 13px;
  font-weight: t.$font-weight-semibold;
  min-width: 22px;
  text-align: center;
  line-height: 22px;
  color: t.$color-text-primary;
}

// ── Row right-side ────────────────────────────────────────────────────────────
.item-subtotal {
  font-size: 12px;
  font-weight: t.$font-weight-bold;
  color: t.$color-primary;
  min-width: 44px;
  text-align: right;
  flex-shrink: 0;
}

.item-remove {
  display: flex;
  align-items: center;
  justify-content: center;
  width: 22px;
  height: 22px;
  border: none;
  background: transparent;
  cursor: pointer;
  border-radius: 50%;
  color: #ccc;
  padding: 0;
  flex-shrink: 0;
  transition: color 0.15s, background 0.15s;

  &:hover { color: t.$color-danger-light; background: rgba(211,47,47,0.08); }

  mat-icon { font-size: 14px; width: 14px; height: 14px; line-height: 14px; }
}

.compact-field {
  --mdc-outlined-text-field-container-height: 44px;
  margin-bottom: 4px;
}

.empty-cart {
  flex: 1;
  @include t.flex-column;
  align-items: center;
  justify-content: center;
  padding: t.$space-xxl t.$space-lg;
  color: t.$color-text-muted;

  mat-icon { font-size: 56px; width: 56px; height: 56px; color: t.$color-border; }
  p { font-size: t.$font-size-md; margin: t.$space-sm 0 t.$space-xs; }
  small { font-size: t.$font-size-sm; }
}

.cart-footer { padding: 10px t.$space-md 12px; border-top: 1px solid t.$color-divider; background: #fafafa; }

.totals { margin: 6px 0; display: flex; flex-direction: column; gap: 3px; }

.total-row-sm {
  display: flex;
  justify-content: space-between;
  font-size: t.$font-size-sm;
  color: t.$color-text-secondary;
  padding: 2px 0;
}

.total-row-lg {
  display: flex;
  justify-content: space-between;
  font-size: t.$font-size-lg;
  font-weight: t.$font-weight-bold;
  color: t.$color-primary;
  padding: t.$space-sm 0;
}

.checkout-btn { @include t.action-button; width: 100%; margin-top: t.$space-sm; }

.receipt-container { display: flex; justify-content: center; padding: t.$space-lg; }

.receipt-card { max-width: 480px; width: 100%; border-radius: t.$radius-lg !important; }

.receipt-header {
  text-align: center;
  padding: t.$space-md;

  .success-icon { font-size: 56px; width: 56px; height: 56px; color: t.$color-success; }
  h2 { margin: t.$space-sm 0 t.$space-xs; color: t.$color-success-light; }
  p  { margin: 0; color: t.$color-text-secondary; }
}

.receipt-body { padding: t.$space-md 0; display: flex; flex-direction: column; gap: t.$space-sm; }

.receipt-row   { display: flex; justify-content: space-between; font-size: t.$font-size-base; padding: t.$space-xs 0; }
.total-row     { font-size: t.$font-size-lg; font-weight: t.$font-weight-bold; color: t.$color-primary; padding: t.$space-sm 0; }

.loading-center { @include t.loading-center(t.$space-xl); }
