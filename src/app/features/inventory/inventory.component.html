<div class="page-header">
  <h2>Inventory</h2>
</div>

<div *ngIf="lowStockItems.length" class="alert-banner">
  <mat-icon>warning</mat-icon>
  <strong>{{ lowStockItems.length }} item(s)</strong> need attention (low stock or out of stock)
</div>

<mat-card class="card">
  <div *ngIf="loading" style="display:flex;justify-content:center;padding:48px"><mat-spinner diameter="40"></mat-spinner></div>
  <table mat-table [dataSource]="inventory" *ngIf="!loading" class="full-width">
    <ng-container matColumnDef="productName">
      <th mat-header-cell *matHeaderCellDef>Product</th>
      <td mat-cell *matCellDef="let i"><strong>{{ i.productName }}</strong></td>
    </ng-container>
    <ng-container matColumnDef="sku">
      <th mat-header-cell *matHeaderCellDef>SKU</th>
      <td mat-cell *matCellDef="let i">{{ i.productSku || 'â€”' }}</td>
    </ng-container>
    <ng-container matColumnDef="quantity">
      <th mat-header-cell *matHeaderCellDef>Quantity</th>
      <td mat-cell *matCellDef="let i" [class.zero-qty]="i.quantity === 0"><strong>{{ i.quantity }}</strong></td>
    </ng-container>
    <ng-container matColumnDef="threshold">
      <th mat-header-cell *matHeaderCellDef>Low Stock At</th>
      <td mat-cell *matCellDef="let i">{{ i.lowStockThreshold }}</td>
    </ng-container>
    <ng-container matColumnDef="status">
      <th mat-header-cell *matHeaderCellDef>Status</th>
      <td mat-cell *matCellDef="let i">
        <mat-chip [class]="statusClass(i.stockStatus)">{{ statusLabel(i.stockStatus) }}</mat-chip>
      </td>
    </ng-container>
    <ng-container matColumnDef="updatedAt">
      <th mat-header-cell *matHeaderCellDef>Last Updated</th>
      <td mat-cell *matCellDef="let i">{{ i.updatedAt | date:'short' }}</td>
    </ng-container>
    <ng-container matColumnDef="actions">
      <th mat-header-cell *matHeaderCellDef class="text-right">Actions</th>
      <td mat-cell *matCellDef="let i" class="text-right">
        <button mat-icon-button color="primary" (click)="openUpdateDialog(i)" matTooltip="Update stock">
          <mat-icon>edit</mat-icon>
        </button>
      </td>
    </ng-container>
    <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
    <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
  </table>
</mat-card>
